<!DOCTYPE html>


<html class="writer-html5" lang="en" >
<!-- Copyright (C) 2020-2021, Marek Gagolewski <https://www.gagolewski.com> -->

<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>14. ðŸš§ Introduction to Data Frames in pandas &mdash; Minimalist Data Wrangling with Python by Marek Gagolewski</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/proof.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  

  
  

  
    <link rel="canonical" href="https://datawranglingpy.gagolewski.com/chapter/410-dataframe.html" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/proof.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="15. ðŸš§ Basic Operations on Data Frames" href="420-transform-hetero.html" />
    <link rel="prev" title="13. ðŸš§ Multivariate Categorical and Relational Data" href="340-categorical-multi.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html"> Minimalist Data Wrangling with Python [DRAFTv0.1.1]
          

          
          </a>

          <div class="version">
          by <a style="color: inherit" href="https://www.gagolewski.com">Marek Gagolewski</a>
          </div>

<!--
          
            
            
              <div class="version">
                by Marek Gagolewski
              </div>
            
          
-->

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search phrase..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Start Here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="000-preface.html">Preface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introducing Python</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="110-jupyter.html">1. Getting Started with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="120-scalar.html">2. Scalar Types in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="130-sequential.html">3. Sequential and Other Types in Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Unidimensional Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="210-vector.html">4. Introduction to Vectors in <strong class="program">numpy</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="220-histogram.html">5. Inspecting the Distribution of Numeric Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="230-aggregate.html">6. Descriptive Statistics for Numeric Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="240-transform-uni.html">7. Transforming and Filtering Numeric Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="250-distribution-uni.html">8. ðŸš§ Continuous Probability Distributions (**)</a></li>
<li class="toctree-l1"><a class="reference internal" href="260-categorical-uni.html">9. ðŸš§ Handling Categorical Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Multidimensional Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="310-matrix.html">10. Introduction to Matrices in <strong class="program">numpy</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="320-transform-multi.html">11. ðŸš§ Transforming, Aggregating, and Filtering Multidimensional Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="330-visualise-multi.html">12. ðŸš§ Visualising Multidimensional Data and Measuring Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="340-categorical-multi.html">13. ðŸš§ Multivariate Categorical and Relational Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Heterogeneous Data</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">14. ðŸš§ Introduction to Data Frames in <strong class="program">pandas</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-data-frames">14.1. Creating Data Frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="#representing-data-frames">14.2. Representing Data Frames</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#series">14.2.1. <code class="docutils literal notranslate"><span class="pre">Series</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#index">14.2.2. <code class="docutils literal notranslate"><span class="pre">Index</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#further-reading">14.3. Further Reading</a></li>
<li class="toctree-l2"><a class="reference internal" href="#questions">14.4. Questions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="420-transform-hetero.html">15. ðŸš§ Basic Operations on Data Frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="430-reshape.html">16. ðŸš§ Reshaping and Fusing Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="440-groupby.html">17. ðŸš§ Observation Grouping</a></li>
<li class="toctree-l1"><a class="reference internal" href="450-sql.html">18. Database Access</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Text and Other Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="510-text.html">19. Working with Text Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="520-regex.html">20. Regular Expressions (*)</a></li>
<li class="toctree-l1"><a class="reference internal" href="530-missingness.html">21. Outliers, Missing, Censored, and Incorrect Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="540-time.html">22. Time Series</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="998-changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="999-bibliography.html">Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://datawranglingpy.gagolewski.com/datawranglingpy.pdf">This Book in PDF</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/datawranglingpy/blob/master/CODE_OF_CONDUCT.md">Report Bugs or Typos</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/teaching_data">Datasets</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.gagolewski.com">Author</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Minimalist Data Wrangling with Python [DRAFTv0.1.1]</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><span class="section-number">14. </span>ðŸš§ Introduction to Data Frames in <strong class="program">pandas</strong></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="420-transform-hetero.html" class="btn btn-neutral float-right" title="15. ðŸš§ Basic Operations on Data Frames" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="340-categorical-multi.html" class="btn btn-neutral float-left" title="13. ðŸš§ Multivariate Categorical and Relational Data" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="introduction-to-data-frames-in-pandas">
<span id="chap-dataframe"></span><h1><span class="section-number">14. </span>ðŸš§ Introduction to Data Frames in <strong class="program">pandas</strong><a class="headerlink" href="#introduction-to-data-frames-in-pandas" title="Permalink to this headline">Â¶</a></h1>
<blockquote>
<div><p><em>This is an early draft of</em> Minimalist Data Wrangling with Python <em>by
<a class="reference external" href="https://www.gagolewski.com">Marek Gagolewski</a>. It is distributed
in the hope that it will be useful. Any
<a class="reference external" href="https://github.com/gagolews/datawranglingpy/blob/master/CODE_OF_CONDUCT.md">bug/typos reports/fixes</a>
are appreciated. Although available online, this is a whole course,
and should be read from the beginning to the end. In particular,
refer to the <a class="reference internal" href="000-preface.html#chap-preface"><span class="std std-ref">Preface</span></a> for general introductory remarks.</em></p>
</div></blockquote>
<p><strong class="program">numpy</strong> arrays are an extremely versatile tool for performing data analysis
and other numerical computations computations of various kinds.
Although theoretically possible otherwise, however,
we only store elements of the same type therein, most often numbers.</p>
<p><a class="reference external" href="https://pandas.pydata.org/"><strong class="program">pandas</strong></a> <span id="id1">[<a class="reference internal" href="999-bibliography.html#id9">McK17</a>]</span> is amongst over
<a class="reference external" href="https://libraries.io/pypi/numpy">one hundred thousand</a>
of open source packages and repositories that use <strong class="program">numpy</strong> to provide
additional data wrangling functionality.
It was originally written by Wes McKinney
and was heavily inspired by the <code class="docutils literal notranslate"><span class="pre">data.frame</span></code> objects in S and R
as well as tables in relational (think: SQL) databases
and spreadsheets.</p>
<p>The <strong class="program">pandas</strong> package delivers a few classes, of which the most important are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> â€“ for representing tabular data (matrix-like)
with columns of possibly different types,
in particular a mix of numerical and categorical variables,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Series</span></code> â€“ vector-like objects for representing individual columns,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Index</span></code> â€“ vector-like objects for labelling individual rows and columns
of <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s and items in <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects,</p></li>
</ul>
<p>together with many methods for:</p>
<ul class="simple">
<li><p>transforming/aggregating/processing data
in groups determined by categorical variables or Cartesian products thereof,</p></li>
<li><p>reshaping (e.g., from wide to long format) and joining datasets,</p></li>
<li><p>importing/exporting data from/to various sources and formats,
e.g., CSV and HDF5 files or relational databases,</p></li>
<li><p>handling missing data.</p></li>
</ul>
<blockquote>
<div><p><strong>Important.</strong> Let us repeat: <strong class="program">pandas</strong> is built on top of
<strong class="program">numpy</strong> and most objects therein can be processed by
<strong class="program">numpy</strong> functions as well.
Other functions (e.g., in <strong class="program">seaborn</strong> or <strong class="program">sklearn</strong>)
will be accepting both <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> objects,
but will be converting the former to the latter
automatically to enable data processing using
fast C/C++/Fortran routines.
What we have learnt so far still applies.
But there is of course more, hence this part.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.notebook_repr_html&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># disable &quot;rich&quot; output</span>
<span class="n">pd</span><span class="o">.</span><span class="n">__version__</span>  <span class="c1"># FYI</span>
<span class="c1">## &#39;1.4.1&#39;</span>
</pre></div>
</div>
<div class="section" id="creating-data-frames">
<h2><span class="section-number">14.1. </span>Creating Data Frames<a class="headerlink" href="#creating-data-frames" title="Permalink to this headline">Â¶</a></h2>
<p>Data frames can be created, amongst others,
using the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> class constructor, which
can be fed, for example, with a <strong class="program">numpy</strong> matrix:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="c1">##           a         b         c</span>
<span class="c1">## 0  0.696469  0.286139  0.226851</span>
<span class="c1">## 1  0.551315  0.719469  0.423106</span>
<span class="c1">## 2  0.980764  0.684830  0.480932</span>
<span class="c1">## 3  0.392118  0.343178  0.729050</span>
</pre></div>
</div>
<p>Note that rows and columns are labelled (and how readable that
finally is!).</p>
<p>A dictionary of vector-like objects of equal lengths is another
common option:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">u</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
    <span class="n">w</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">],</span>
    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;bacon&quot;</span><span class="p">,</span> <span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;eggs&quot;</span><span class="p">]</span>
<span class="p">))</span>
<span class="c1">##       u      v  w      x</span>
<span class="c1">## 0  0.70   True  A   spam</span>
<span class="c1">## 1  0.29   True  B   spam</span>
<span class="c1">## 2  0.23  False  C  bacon</span>
<span class="c1">## 3  0.55  False  D   spam</span>
<span class="c1">## 4  0.72   True  E   eggs</span>
</pre></div>
</div>
<p>This illustrates the possibility of having columns of different
types.</p>
<blockquote>
<div><p>Check out the <strong class="command">pandas.DataFrame.from_dict</strong> and
<strong class="command">pandas.DataFrame.from_records</strong>
methods in the <a class="reference external" href="https://pandas.pydata.org/docs/">documentation</a>.
Use them to create some example data frames.</p>
</div></blockquote>
<p>Further, data frames can be read from files in different
formats, for instance, CSV:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">body</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/gagolews/&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;teaching_data/master/marek/nhanes_adult_female_bmx_2020.csv&quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
<span class="n">body</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>  <span class="c1"># display first few rows (5 by default)</span>
<span class="c1">##    BMXWT  BMXHT  BMXARML  BMXLEG  BMXARMC  BMXHIP  BMXWAIST</span>
<span class="c1">## 0   97.1  160.2     34.7    40.8     35.8   126.1     117.9</span>
<span class="c1">## 1   91.1  152.7     33.5    33.0     38.5   125.5     103.1</span>
<span class="c1">## 2   73.0  161.2     37.4    38.0     31.8   106.2      92.0</span>
<span class="c1">## 3   61.7  157.4     38.0    34.7     29.0   101.0      90.5</span>
<span class="c1">## 4   55.4  154.6     34.6    34.0     28.3    92.5      73.2</span>
</pre></div>
</div>
<blockquote>
<div><p>Check out the other <strong class="command">pandas.read_*</strong> functions
in the <strong class="program">pandas</strong> documentation â€“ some of which we shall
be discussing later.</p>
</div></blockquote>
</div>
<div class="section" id="representing-data-frames">
<h2><span class="section-number">14.2. </span>Representing Data Frames<a class="headerlink" href="#representing-data-frames" title="Permalink to this headline">Â¶</a></h2>
<p>Data frames are modelled through <strong class="program">numpy</strong> matrices,
hence we can feel quite at home with them.</p>
<p>For example, given:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">u</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
    <span class="n">w</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">],</span>
    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;bacon&quot;</span><span class="p">,</span> <span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;eggs&quot;</span><span class="p">]</span>
<span class="p">))</span>
<span class="n">df</span>
<span class="c1">##       u      v  w      x</span>
<span class="c1">## 0  0.70   True  A   spam</span>
<span class="c1">## 1  0.29   True  B   spam</span>
<span class="c1">## 2  0.23  False  C  bacon</span>
<span class="c1">## 3  0.55  False  D   spam</span>
<span class="c1">## 4  0.72   True  E   eggs</span>
</pre></div>
</div>
<p>it is easy to fetch the number of rows and columns:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
<span class="c1">## (5, 4)</span>
</pre></div>
</div>
<p>or the type of each column:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="c1">## u    float64</span>
<span class="c1">## v       bool</span>
<span class="c1">## w     object</span>
<span class="c1">## x     object</span>
<span class="c1">## dtype: object</span>
</pre></div>
</div>
<p>Recall that arrays are equipped with the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> slot.</p>
<div class="section" id="series">
<h3><span class="section-number">14.2.1. </span><code class="docutils literal notranslate"><span class="pre">Series</span></code><a class="headerlink" href="#series" title="Permalink to this headline">Â¶</a></h3>
<p>There is a separate class for storing individual data frame
columns: it is called <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;u&quot;</span><span class="p">]</span>  <span class="c1"># extract the `u` column</span>
<span class="n">s</span>
<span class="c1">## 0    0.70</span>
<span class="c1">## 1    0.29</span>
<span class="c1">## 2    0.23</span>
<span class="c1">## 3    0.55</span>
<span class="c1">## 4    0.72</span>
<span class="c1">## Name: u, dtype: float64</span>
</pre></div>
</div>
<p>Note that a data frame with one column is printed
out slightly differently:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="c1">##       u</span>
<span class="c1">## 0  0.70</span>
<span class="c1">## 1  0.29</span>
<span class="c1">## 2  0.23</span>
<span class="c1">## 3  0.55</span>
<span class="c1">## 4  0.72</span>
</pre></div>
</div>
<p>Indexing will of course be discussed later.</p>
<blockquote>
<div><p><strong>Important.</strong>
It is crucial to know when we are dealing
with a <code class="docutils literal notranslate"><span class="pre">Series</span></code> and when with a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object,
because each of them defines a slightly different set of methods.</p>
</div></blockquote>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="c1">## 0.49800000000000005</span>
</pre></div>
</div>
<p>refers to <strong class="command">pandas.Series.mean</strong> (which returns a scalar), whereas</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">## u    0.498</span>
<span class="c1">## v    0.600</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<p>uses <strong class="command">pandas.DataFrame.mean</strong> (which yields a <code class="docutils literal notranslate"><span class="pre">Series</span></code>).</p>
<blockquote>
<div><p><strong>Exercise.</strong> Look up the two methods in the <strong class="program">pandas</strong> manual.
Note that their argument list is slightly different.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">Series</span></code> are wrappers around <strong class="program">numpy</strong> arrays.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">values</span>
<span class="c1">## array([0.7 , 0.29, 0.23, 0.55, 0.72])</span>
</pre></div>
</div>
<p>Most importantly, <strong class="program">numpy</strong> functions can be called directly on them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="c1">## 0.49800000000000005</span>
</pre></div>
</div>
<p>Hence, what we have covered in the part dealing with vector
processing still holds for data frame columns as well (there will be more,
stay tuned).</p>
<p><code class="docutils literal notranslate"><span class="pre">Series</span></code> can also be <em>named</em>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span>
<span class="c1">## &#39;u&#39;</span>
</pre></div>
</div>
<p>This is convenient
when we convert from/to a data frame.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;spam&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="c1">##    spam</span>
<span class="c1">## 0  0.70</span>
<span class="c1">## 1  0.29</span>
<span class="c1">## 2  0.23</span>
<span class="c1">## 3  0.55</span>
<span class="c1">## 4  0.72</span>
</pre></div>
</div>
</div>
<div class="section" id="index">
<h3><span class="section-number">14.2.2. </span><code class="docutils literal notranslate"><span class="pre">Index</span></code><a class="headerlink" href="#index" title="Permalink to this headline">Â¶</a></h3>
<p>Another important class is <code class="docutils literal notranslate"><span class="pre">Index</span></code>, which
is used for encoding the row and column names in a data frame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>  <span class="c1"># row labels</span>
<span class="c1">## RangeIndex(start=0, stop=5, step=1)</span>
</pre></div>
</div>
<p>The above represents a sequence 0, 1, â€¦, 4.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>  <span class="c1"># column labels</span>
<span class="c1">## Index([&#39;u&#39;, &#39;v&#39;, &#39;w&#39;, &#39;x&#39;], dtype=&#39;object&#39;)</span>
</pre></div>
</div>
<p>Also, we can label the individual elements in <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">index</span>
<span class="c1">## RangeIndex(start=0, stop=5, step=1)</span>
</pre></div>
</div>
<p>A quite frequent operation that weâ€™ll be applying
to make a data frame column act as a vector of row labels
is implemented in the <code class="docutils literal notranslate"><span class="pre">set_index</span></code> method for data frames:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">df2</span>
<span class="c1">##           u      v  w</span>
<span class="c1">## x                    </span>
<span class="c1">## spam   0.70   True  A</span>
<span class="c1">## spam   0.29   True  B</span>
<span class="c1">## bacon  0.23  False  C</span>
<span class="c1">## spam   0.55  False  D</span>
<span class="c1">## eggs   0.72   True  E</span>
</pre></div>
</div>
<p>Note that this <code class="docutils literal notranslate"><span class="pre">Index</span></code> object is named:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span>
<span class="c1">## &#39;x&#39;</span>
</pre></div>
</div>
<p>which is handy when we decide that we want to convert
the vector of row labels back to a standalone column:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1">##        x     u      v  w</span>
<span class="c1">## 0   spam  0.70   True  A</span>
<span class="c1">## 1   spam  0.29   True  B</span>
<span class="c1">## 2  bacon  0.23  False  C</span>
<span class="c1">## 3   spam  0.55  False  D</span>
<span class="c1">## 4   eggs  0.72   True  E</span>
</pre></div>
</div>
<p>There is also an option to get rid of the current <code class="docutils literal notranslate"><span class="pre">.index</span></code>
and to replace it with the default label sequence, i.e.,
0, 1, 2, â€¦:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">##       u      v  w</span>
<span class="c1">## 0  0.70   True  A</span>
<span class="c1">## 1  0.29   True  B</span>
<span class="c1">## 2  0.23  False  C</span>
<span class="c1">## 3  0.55  False  D</span>
<span class="c1">## 4  0.72   True  E</span>
</pre></div>
</div>
<blockquote>
<div><p><strong>Important.</strong> In due course, we will be calling
<code class="docutils literal notranslate"><span class="pre">df.reset_index(drop=True)</span></code> quite frequently, sometimes
more than once in a single chain of commands.</p>
</div></blockquote>
<blockquote>
<div><p><strong>Exercise.</strong> Use the
<strong class="command">pandas.DataFrame.rename</strong> method to
change the name of the <code class="docutils literal notranslate"><span class="pre">u</span></code> column in <code class="docutils literal notranslate"><span class="pre">df</span></code> to <code class="docutils literal notranslate"><span class="pre">spam</span></code>.</p>
</div></blockquote>
<p>Also, a <em>hierarchical</em> index â€“ one that is comprised
of more than two levels â€“ is possible:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">])</span>
<span class="c1">##                 u  w</span>
<span class="c1">## x     v             </span>
<span class="c1">## spam  True   0.70  A</span>
<span class="c1">##       True   0.29  B</span>
<span class="c1">##       False  0.55  D</span>
<span class="c1">## eggs  True   0.72  E</span>
<span class="c1">## bacon False  0.23  C</span>
</pre></div>
</div>
<p>Note that a group of three consecutive <code class="docutils literal notranslate"><span class="pre">spam</span></code>s
does not have the labels repeated â€“ this is for increased
readability.</p>
<blockquote>
<div><p><strong>Important.</strong>
We will soon see that hierarchical indexes might arise
after aggregating data in groups (via the <strong class="command">groupby</strong> method).</p>
</div></blockquote>
<p>For <a class="reference external" href="https://wwwn.cdc.gov/Nchs/Nhanes/2017-2018/P_DEMO.htm">example</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nhanes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/gagolews/&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;teaching_data/master/marek/nhanes_p_demo_bmx_2020.csv&quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">nhanes</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;RIAGENDR&quot;</span><span class="p">,</span> <span class="s2">&quot;DMDEDUC2&quot;</span><span class="p">])[</span><span class="s2">&quot;BMXBMI&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">res</span>  <span class="c1"># BMI by gender and education</span>
<span class="c1">## RIAGENDR  DMDEDUC2</span>
<span class="c1">## 1         1.0         28.765244</span>
<span class="c1">##           2.0         28.534737</span>
<span class="c1">##           3.0         29.637793</span>
<span class="c1">##           4.0         30.323158</span>
<span class="c1">##           5.0         28.689736</span>
<span class="c1">##           9.0         28.080000</span>
<span class="c1">## 2         1.0         30.489032</span>
<span class="c1">##           2.0         31.251247</span>
<span class="c1">##           3.0         30.969200</span>
<span class="c1">##           4.0         31.471476</span>
<span class="c1">##           5.0         28.891357</span>
<span class="c1">##           7.0         30.200000</span>
<span class="c1">##           9.0         33.950000</span>
<span class="c1">## Name: BMXBMI, dtype: float64</span>
</pre></div>
</div>
<p>But let us fret not, as there is always:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1">##     RIAGENDR  DMDEDUC2     BMXBMI</span>
<span class="c1">## 0          1       1.0  28.765244</span>
<span class="c1">## 1          1       2.0  28.534737</span>
<span class="c1">## 2          1       3.0  29.637793</span>
<span class="c1">## 3          1       4.0  30.323158</span>
<span class="c1">## 4          1       5.0  28.689736</span>
<span class="c1">## 5          1       9.0  28.080000</span>
<span class="c1">## 6          2       1.0  30.489032</span>
<span class="c1">## 7          2       2.0  31.251247</span>
<span class="c1">## 8          2       3.0  30.969200</span>
<span class="c1">## 9          2       4.0  31.471476</span>
<span class="c1">## 10         2       5.0  28.891357</span>
<span class="c1">## 11         2       7.0  30.200000</span>
<span class="c1">## 12         2       9.0  33.950000</span>
</pre></div>
</div>
<p>First things first, though â€“ in the next part
we shall discuss some more basic operations.</p>
</div>
</div>
<div class="section" id="further-reading">
<h2><span class="section-number">14.3. </span>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this headline">Â¶</a></h2>
<p>McKinney W. <em>Python for Data Analysis: Data Wrangling with Pandas, NumPy, and IPython</em>, Oâ€™Reilly, 2017.</p>
<p>Data frames were first introduced in the 1991 version
of the S language (Chambers J.M., Hastie T.J., <em>Statistical Models in S</em>, Pacific Grove, CA, USA: Wadsworth &amp; Brooks/Cole,  1991).</p>
</div>
<div class="section" id="questions">
<h2><span class="section-number">14.4. </span>Questions<a class="headerlink" href="#questions" title="Permalink to this headline">Â¶</a></h2>
<div class="proof proof-type-exercise" id="id2">

    <div class="proof-title">
        <span class="proof-type">Exercise 14.1</span>
        
    </div><div class="proof-content">
<p>How are data frames different from matrices?</p>
</div></div><div class="proof proof-type-exercise" id="id3">

    <div class="proof-title">
        <span class="proof-type">Exercise 14.2</span>
        
    </div><div class="proof-content">
<p>What are the use cases of the <code class="docutils literal notranslate"><span class="pre">name</span></code> slot
in <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">Index</span></code> objects?</p>
</div></div><div class="proof proof-type-exercise" id="id4">

    <div class="proof-title">
        <span class="proof-type">Exercise 14.3</span>
        
    </div><div class="proof-content">
<p>What is the purpose of <strong class="command">set_index</strong> and <strong class="command">reset_index</strong>?</p>
</div></div></div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="420-transform-hetero.html" class="btn btn-neutral float-right" title="15. ðŸš§ Basic Operations on Data Frames" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="340-categorical-multi.html" class="btn btn-neutral float-left" title="13. ðŸš§ Multivariate Categorical and Relational Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Marek Gagolewski. Licensed under CC BY-NC-ND 4.0.
      <span class="lastupdated">
        Last updated on 2022-03-29T16:43:07+1100.
      </span>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a>
    and a customised <a href="https://github.com/rtfd/sphinx_rtd_theme">rtd</a> theme.
    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>