<!DOCTYPE html>


<html class="writer-html5" lang="en" >
<!-- Copyright (C) 2020-2021, Marek Gagolewski <https://www.gagolewski.com> -->

<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>18. Basic Operations on Data Frames &mdash; Minimalist Data Wrangling with Python by Marek Gagolewski</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/proof.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  

  
  

  
    <link rel="canonical" href="https://datawranglingpy.gagolewski.com/chapter/420-transform-hetero.html" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/proof.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="19. Reshaping and Fusing Datasets" href="430-reshape.html" />
    <link rel="prev" title="17. Introduction to Data Frames in pandas" href="410-dataframe.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html"> Minimalist Data Wrangling with Python [DRAFTv0.1]
          

          
          </a>

          <div class="version">
          by <a style="color: inherit" href="https://www.gagolewski.com">Marek Gagolewski</a>
          </div>

<!--
          
            
            
              <div class="version">
                by Marek Gagolewski
              </div>
            
          
-->

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search phrase..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Start Here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="000-preface.html">Preface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introducing Python</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="110-jupyter.html">1. Getting Started with Python and JupyterLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="120-scalar.html">2. Scalar Types in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="130-sequential.html">3. Sequential and Other Types in Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Unidimensional Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="210-vector.html">4. Introduction to Vectors in <em>numpy</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="220-histogram.html">5. Inspecting the Distribution of Numeric Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="230-aggregate.html">6. Descriptive Statistics for Continuous Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="240-transform-uni.html">7. Transforming and Filtering Continuous Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="250-distribution-uni.html">8. Continuous Probability Distributions (**)</a></li>
<li class="toctree-l1"><a class="reference internal" href="260-categorical-uni.html">9. Handling Categorical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="270-time-uni.html">10. Processing Time Series</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Multidimensional Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="310-matrix.html">11. Introduction to Matrices in <em>numpy</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="320-transform-multi.html">12. Transforming, Aggregating, and Filtering Multidimensional Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="330-categorical-multi.html">13. Multivariate Categorical and Relational Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="330-visualise-multi.html">14. Visualising Multidimensional Data and Measuring Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="350-time-multi.html">15. Multidimensional Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="360-image.html">16. Notes on Signal Processing (Audio, Image, Video)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Heterogeneous Data</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="410-dataframe.html">17. Introduction to Data Frames in <em>pandas</em></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">18. Basic Operations on Data Frames</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#aggregating">18.1. Aggregating</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transforming">18.2. Transforming</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filtering">18.3. Filtering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#series">18.3.1. <code class="docutils literal notranslate"><span class="pre">Series</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#do-not-use-directly">18.3.1.1. Do Not Use <code class="docutils literal notranslate"><span class="pre">[...]</span></code> Directly</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loc">18.3.1.2. <code class="docutils literal notranslate"><span class="pre">loc[...]</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iloc">18.3.1.3. <code class="docutils literal notranslate"><span class="pre">iloc[...]</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#logical-indexing">18.3.1.4. Logical Indexing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dataframe">18.3.2. <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-rows-and-columns">18.3.3. Adding Rows and Columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#random-sampling">18.3.4. Random Sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hierarchical-indices">18.3.5. Hierarchical Indices (*)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#further-reading">18.4. Further Reading</a></li>
<li class="toctree-l2"><a class="reference internal" href="#questions">18.5. Questions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="430-reshape.html">19. Reshaping and Fusing Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="440-groupby.html">20. Observation Grouping</a></li>
<li class="toctree-l1"><a class="reference internal" href="450-missingness.html">21. Outliers, Missing, Censored, and Incorrect Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="460-sql.html">22. Database Access</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Text Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="510-text.html">23. Working with Text Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="520-regex.html">24. Regular Expressions (*)</a></li>
<li class="toctree-l1"><a class="reference internal" href="530-webscrape.html">25. Fetching and Cleaning Text Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="999-bibliography.html">Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/datawranglingpy/blob/master/CODE_OF_CONDUCT.md">Report Bugs or Typos</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.gagolewski.com">Author</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Minimalist Data Wrangling with Python [DRAFTv0.1]</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><span class="section-number">18. </span>Basic Operations on Data Frames</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="430-reshape.html" class="btn btn-neutral float-right" title="19. Reshaping and Fusing Datasets" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="410-dataframe.html" class="btn btn-neutral float-left" title="17. Introduction to Data Frames in pandas" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="basic-operations-on-data-frames">
<span id="chap-transform-hetero"></span><h1><span class="section-number">18. </span>Basic Operations on Data Frames<a class="headerlink" href="#basic-operations-on-data-frames" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p><em>Minimalist Data Wrangling with Python</em> is a very-early-and-rough-draft
of the forthcoming (ETA 2023) textbook by
<a class="reference external" href="https://www.gagolewski.com">Marek Gagolewski</a>.
It is distributed in the hope that it will be useful.
If you detect any bugs or typos, please share them by
<a class="reference external" href="https://github.com/gagolews/datawranglingpy/blob/master/CODE_OF_CONDUCT.md">email</a>.
Although available online, this is a whole course, and should be read
from the beginning to the end. In particular, refer to the Preface for
general introductory remarks. Enjoy.</p>
</div></blockquote>
<p>Looking at the list of methods
for the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and <code class="docutils literal notranslate"><span class="pre">Series</span></code> classes in the <em>pandas</em> package’s
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/index.html">documentation</a>,
we can see that they are abundant.
Together with the object-oriented syntax, we will often find ourselves
appreciating the high readability of even quite complex operation
chains such as <code class="docutils literal notranslate"><span class="pre">data.drop_duplicates().groupby([&quot;year&quot;,</span> <span class="pre">&quot;month&quot;]).mean().reset_index()</span></code>.</p>
<p>Nevertheless, in fact, we should admit that the methods are too
plentiful – they make an impression that someone was too generous
by including a list of all the possible <em>verbs</em> related to data analysis,
even if they can be easily expressed as a combination of 2-3 simpler
operations.
Therefore, in order to prevent the reader from
being overloaded with too much new information, below we will be
discussing only the most noteworthy features
that often appear in data wrangling scenarios.</p>
<p>As strong advocates of minimalism
(which is more environmentally friendly and sustainable),
not rarely will we be more eager to fall back to the hand-crafted
combinations of the more basic (universal) building blocks from <em>numpy</em>
and <em>scipy</em> instead. This is also in line with our
putting emphasis on developing <em>transferable</em> skills –
as Python with <em>pandas</em> is not the only combo
where we can work with data frames
(e.g., base R allows that too).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.notebook_repr_html&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># disable &quot;rich&quot; output</span>
</pre></div>
</div>
<div class="section" id="aggregating">
<h2><span class="section-number">18.1. </span>Aggregating<a class="headerlink" href="#aggregating" title="Permalink to this headline">¶</a></h2>
<p>Here is an example data frame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;bacon&quot;</span><span class="p">,</span> <span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;eggs&quot;</span><span class="p">,</span> <span class="s2">&quot;sausage&quot;</span><span class="p">]</span>
<span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">])</span>
<span class="n">d</span>
<span></span><span class="c1">##       u     v        w</span>
<span class="c1">## a  0.70  0.32     spam</span>
<span class="c1">## b  0.29 -0.05    bacon</span>
<span class="c1">## c  0.23 -0.20     spam</span>
<span class="c1">## d  0.55  1.98     eggs</span>
<span class="c1">## e  0.72 -1.62  sausage</span>
</pre></div>
</div>
<p>First, all <em>numpy</em> functions can be applied directly on individual
columns (i.e., objects of type <code class="docutils literal notranslate"><span class="pre">Series</span></code>),
as the latter are, after all,  vector-like.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;u&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span></span><span class="c1">## array([0.23, 0.55, 0.72])</span>
</pre></div>
</div>
<p>For more details on the <code class="docutils literal notranslate"><span class="pre">loc[...]</span></code>-type indexing, see below.
By then, the meaning of the above should be clear from the
context.</p>
<p>Most <em>numpy</em> functions also work if they are fed with data frames,
but we will need to extract the numeric matrix columns manually.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span></span><span class="c1">## array([[ 0.23, -1.62],</span>
<span class="c1">##        [ 0.55, -0.05],</span>
<span class="c1">##        [ 0.72,  1.98]])</span>
</pre></div>
</div>
<p>Sometimes the results will automatically be coerced to a <code class="docutils literal notranslate"><span class="pre">Series</span></code> object
with <code class="docutils literal notranslate"><span class="pre">index</span></code> slot set appropriately:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span></span><span class="c1">## u    0.498</span>
<span class="c1">## v    0.086</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<p>Many operations, for convenience, have also
been implemented as methods in the <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>
classes, e.g.,
<code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">median</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">quantile</span></code>,
<code class="docutils literal notranslate"><span class="pre">var</span></code>, <code class="docutils literal notranslate"><span class="pre">std</span></code> (with <code class="docutils literal notranslate"><span class="pre">ddof=1</span></code> by default, interestingly)
<code class="docutils literal notranslate"><span class="pre">skew</span></code>, <code class="docutils literal notranslate"><span class="pre">kurt</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span><span class="c1">## u    0.498</span>
<span class="c1">## v    0.086</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span></span><span class="c1">##         u     v</span>
<span class="c1">## 0.0  0.23 -1.62</span>
<span class="c1">## 0.5  0.55 -0.05</span>
<span class="c1">## 1.0  0.72  1.98</span>
</pre></div>
</div>
<p>Also let us note the <code class="docutils literal notranslate"><span class="pre">describe</span></code> method, which
returns a few statistics at the same time.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span></span><span class="c1">##               u         v</span>
<span class="c1">## count  5.000000  5.000000</span>
<span class="c1">## mean   0.498000  0.086000</span>
<span class="c1">## std    0.227969  1.289643</span>
<span class="c1">## min    0.230000 -1.620000</span>
<span class="c1">## 25%    0.290000 -0.200000</span>
<span class="c1">## 50%    0.550000 -0.050000</span>
<span class="c1">## 75%    0.700000  0.320000</span>
<span class="c1">## max    0.720000  1.980000</span>
</pre></div>
</div>
<p>(*) Let us stress that above we see
the corrected version of standard deviation,
given by <span class="math notranslate nohighlight">\(\sqrt{\frac{1}{n-1} \cdots}\)</span>.</p>
<blockquote>
<div><p><strong>Exercise.</strong>
Check out the <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.agg</span></code> method
that can apply all aggregating operations from
a given list of functions.
Write a call equivalent to <code class="docutils literal notranslate"><span class="pre">d.describe()</span></code>.</p>
</div></blockquote>
</div>
<div class="section" id="transforming">
<h2><span class="section-number">18.2. </span>Transforming<a class="headerlink" href="#transforming" title="Permalink to this headline">¶</a></h2>
<p>By applying the already well-known vectorised mathematical  <em>numpy</em> functions.
we can transform each data cell and return an object of the same type
as the input one.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;u&quot;</span><span class="p">])</span>
<span></span><span class="c1">## a    2.013753</span>
<span class="c1">## b    1.336427</span>
<span class="c1">## c    1.258600</span>
<span class="c1">## d    1.733253</span>
<span class="c1">## e    2.054433</span>
<span class="c1">## Name: u, dtype: float64</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">]])</span>
<span></span><span class="c1">##           u         v</span>
<span class="c1">## a  2.013753  1.377128</span>
<span class="c1">## b  1.336427  0.951229</span>
<span class="c1">## c  1.258600  0.818731</span>
<span class="c1">## d  1.733253  7.242743</span>
<span class="c1">## e  2.054433  0.197899</span>
</pre></div>
</div>
<p>When applying the binary arithmetic, comparison,
and logical operators on an object of class <code class="docutils literal notranslate"><span class="pre">Series</span></code> and
a scalar or a numpy vector, the operations are performed
elementwisely – a style with which we are already familiar.</p>
<p>For instance, here is a standardised version of the <code class="docutils literal notranslate"><span class="pre">u</span></code> column:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;u&quot;</span><span class="p">]</span>
<span class="p">(</span><span class="n">u</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span></span><span class="c1">## a    0.990672</span>
<span class="c1">## b   -1.020098</span>
<span class="c1">## c   -1.314357</span>
<span class="c1">## d    0.255025</span>
<span class="c1">## e    1.088759</span>
<span class="c1">## Name: u, dtype: float64</span>
</pre></div>
</div>
<p>For two objects of class <code class="docutils literal notranslate"><span class="pre">Series</span></code>, the operators
are vectorised somewhat differently
from their <em>numpy</em> counterparts: they are applied
on the pairs of elements having <em>identical labels</em>
(i.e., labelwisely).
Still, if we are transforming the columns
that come from the same data frame
(and thus having identical <code class="docutils literal notranslate"><span class="pre">index</span></code> slots;
this is the most common scenario), there will be no surprises:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;u&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;v&quot;</span><span class="p">]</span>
<span></span><span class="c1">## a     True</span>
<span class="c1">## b     True</span>
<span class="c1">## c     True</span>
<span class="c1">## d    False</span>
<span class="c1">## e     True</span>
<span class="c1">## dtype: bool</span>
</pre></div>
</div>
<p>For transforming many numerical columns at once,
it is a good idea either to
convert them to a numeric matrix explicitly
and then use the basic <em>numpy</em> functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">uv</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">uv</span> <span class="o">=</span> <span class="p">(</span><span class="n">uv</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">uv</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">uv</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">uv</span>
<span></span><span class="c1">## array([[ 0.99067229,  0.20286225],</span>
<span class="c1">##        [-1.0200982 , -0.11790285],</span>
<span class="c1">##        [-1.3143573 , -0.24794275],</span>
<span class="c1">##        [ 0.25502455,  1.64197052],</span>
<span class="c1">##        [ 1.08875866, -1.47898717]])</span>
</pre></div>
</div>
<p>or to use the <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.apply</span></code> method
which invokes a given function on each column separately:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">standardise</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">uv</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">standardise</span><span class="p">)</span>
<span class="n">uv</span>
<span></span><span class="c1">##           u         v</span>
<span class="c1">## a  0.990672  0.202862</span>
<span class="c1">## b -1.020098 -0.117903</span>
<span class="c1">## c -1.314357 -0.247943</span>
<span class="c1">## d  0.255025  1.641971</span>
<span class="c1">## e  1.088759 -1.478987</span>
</pre></div>
</div>
<p>Note that, in both cases, we can then write
<code class="docutils literal notranslate"><span class="pre">d.loc[:,</span> <span class="pre">[&quot;u&quot;,</span> <span class="pre">&quot;v&quot;]]</span> <span class="pre">=</span> <span class="pre">uv</span></code>
to replace the old content with the transformed one.</p>
</div>
<div class="section" id="filtering">
<h2><span class="section-number">18.3. </span>Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h2>
<p>Recall that each <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and <code class="docutils literal notranslate"><span class="pre">Series</span></code> object
is equipped with a slot called <code class="docutils literal notranslate"><span class="pre">index</span></code>, which is
an object of class <code class="docutils literal notranslate"><span class="pre">Index</span></code> (or subclass thereof),
giving the row and element labels, respectively.
It turns out that we may apply
the <em>index</em> operator, <code class="docutils literal notranslate"><span class="pre">[...]</span></code>, to subset  these objects
not only through the <em>indexers</em> known from
the <em>numpy</em> part (e.g., numerical ones, i.e., by position)
but also ones that pinpoint the items via their
labels. That is quite a lot of index-ing.</p>
<p>Let us study different forms thereof in very detail.</p>
<div class="section" id="series">
<h3><span class="section-number">18.3.1. </span><code class="docutils literal notranslate"><span class="pre">Series</span></code><a class="headerlink" href="#series" title="Permalink to this headline">¶</a></h3>
<p>In this section we play with two example objects of
class <code class="docutils literal notranslate"><span class="pre">Series</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
<span class="n">b</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
<span class="n">b</span>
<span></span><span class="c1">## 2    0.70</span>
<span class="c1">## 1    0.29</span>
<span class="c1">## 8    0.23</span>
<span class="c1">## 7    0.55</span>
<span class="c1">## 9    0.72</span>
<span class="c1">## 4    0.42</span>
<span class="c1">## 5    0.98</span>
<span class="c1">## 6    0.68</span>
<span class="c1">## 3    0.48</span>
<span class="c1">## 0    0.39</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;abcdefghij&quot;</span><span class="p">)</span>
<span class="n">c</span>
<span></span><span class="c1">## a    0.70</span>
<span class="c1">## b    0.29</span>
<span class="c1">## c    0.23</span>
<span class="c1">## d    0.55</span>
<span class="c1">## e    0.72</span>
<span class="c1">## f    0.42</span>
<span class="c1">## g    0.98</span>
<span class="c1">## h    0.68</span>
<span class="c1">## i    0.48</span>
<span class="c1">## j    0.39</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<p>They consist of the same values, in the same order,
but have different labels (<code class="docutils literal notranslate"><span class="pre">.index</span></code> slots).
In particular, <code class="docutils literal notranslate"><span class="pre">b</span></code>’s labels
are integers which <em>do not</em> match the physical element
positions (where 0 would denote the first element, etc.).</p>
<p>For <em>numpy</em> vectors, we had four different indexing schemes:
by scalar (extracts an element at given position),
slice, integer vector, and logical vector.
<code class="docutils literal notranslate"><span class="pre">Series</span></code> objects are <em>additionally</em> labelled, therefore
they can <em>additionally</em> be accessed taking into account
the contents of the <code class="docutils literal notranslate"><span class="pre">.index</span></code> slot.</p>
<div class="section" id="do-not-use-directly">
<h4><span class="section-number">18.3.1.1. </span>Do Not Use <code class="docutils literal notranslate"><span class="pre">[...]</span></code> Directly<a class="headerlink" href="#do-not-use-directly" title="Permalink to this headline">¶</a></h4>
<p>Applying the index operator,
<code class="docutils literal notranslate"><span class="pre">[...]</span></code>, directly on <code class="docutils literal notranslate"><span class="pre">Series</span></code> is generally not a good idea:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span></span><span class="c1">## 0.39</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span>
<span></span><span class="c1">## 0    0.39</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<p>both do not select the first item, but the item labelled <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p>However:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># slice - 0 only</span>
<span></span><span class="c1">## 2    0.7</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<p>and</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># there is no label `0`</span>
<span></span><span class="c1">## 0.7</span>
</pre></div>
</div>
<p>fall back to position-based indexing.</p>
<p>Confusing? Well, with some self-discipline, the solution is easy.</p>
<blockquote>
<div><p><strong>Important.</strong> To stay away from potential problems, we should
never apply <code class="docutils literal notranslate"><span class="pre">[...]</span></code> directly on <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects.</p>
</div></blockquote>
</div>
<div class="section" id="loc">
<h4><span class="section-number">18.3.1.2. </span><code class="docutils literal notranslate"><span class="pre">loc[...]</span></code><a class="headerlink" href="#loc" title="Permalink to this headline">¶</a></h4>
<p>To avoid ambiguity, which is what we want,
we should be referring to <code class="docutils literal notranslate"><span class="pre">Series.loc[...]</span></code> and <code class="docutils literal notranslate"><span class="pre">Series.iloc[...]</span></code>
for label- and position-based filtering, respectively.</p>
<p>And thus:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span></span><span class="c1">## 0.39</span>
</pre></div>
</div>
<p>returns the element labelled <code class="docutils literal notranslate"><span class="pre">0</span></code>. On the other
hand, <code class="docutils literal notranslate"><span class="pre">c.loc[0]</span></code> will raise a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>,
because <code class="docutils literal notranslate"><span class="pre">c</span></code> consists of character labels only.</p>
<p>Next, we can use lists of labels to select a <em>subset</em>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">]</span>
<span></span><span class="c1">## 0    0.39</span>
<span class="c1">## 1    0.29</span>
<span class="c1">## 0    0.39</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="p">[</span><span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;j&quot;</span><span class="p">]</span> <span class="p">]</span>
<span></span><span class="c1">## j    0.39</span>
<span class="c1">## b    0.29</span>
<span class="c1">## j    0.39</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<p>The result is always of type <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<p>Slicing behaves differently as the range is <em>inclusive</em>
at both sides:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
<span></span><span class="c1">## 1    0.29</span>
<span class="c1">## 8    0.23</span>
<span class="c1">## 7    0.55</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span></span><span class="c1">## 0    0.39</span>
<span class="c1">## 3    0.48</span>
<span class="c1">## 6    0.68</span>
<span class="c1">## 5    0.98</span>
<span class="c1">## 4    0.42</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">:</span><span class="s2">&quot;g&quot;</span><span class="p">]</span>
<span></span><span class="c1">## d    0.55</span>
<span class="c1">## e    0.72</span>
<span class="c1">## f    0.42</span>
<span class="c1">## g    0.98</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<p>return all elements between the two indicated labels.</p>
<p>Be careful that if there are repeated labels, then
we will be returning all the matching items:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span>
<span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span>
<span></span><span class="c1">## a    1</span>
<span class="c1">## a    3</span>
<span class="c1">## dtype: int64</span>
</pre></div>
</div>
<p>The result is not a scalar but a <code class="docutils literal notranslate"><span class="pre">Series</span></code> object.</p>
</div>
<div class="section" id="iloc">
<h4><span class="section-number">18.3.1.3. </span><code class="docutils literal notranslate"><span class="pre">iloc[...]</span></code><a class="headerlink" href="#iloc" title="Permalink to this headline">¶</a></h4>
<p>Here are some examples of position-based indexing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># the same: c.iloc[0]</span>
<span></span><span class="c1">## 0.7</span>
</pre></div>
</div>
<p>returns the first element.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>  <span class="c1"># the same: b.iloc[1:7]</span>
<span></span><span class="c1">## 1    0.29</span>
<span class="c1">## 8    0.23</span>
<span class="c1">## 7    0.55</span>
<span class="c1">## 9    0.72</span>
<span class="c1">## 4    0.42</span>
<span class="c1">## 5    0.98</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<p>returns the 2nd, 3rd, …, 7th element
(not including <code class="docutils literal notranslate"><span class="pre">b.iloc[7]</span></code>, i.e., the 8th one).</p>
</div>
<div class="section" id="logical-indexing">
<h4><span class="section-number">18.3.1.4. </span>Logical Indexing<a class="headerlink" href="#logical-indexing" title="Permalink to this headline">¶</a></h4>
<p>Indexing using a logical vector-like object
is also available.</p>
<p>We usually will be using <code class="docutils literal notranslate"><span class="pre">loc[...]</span></code>
with either a <code class="docutils literal notranslate"><span class="pre">Series</span></code> object of identical <code class="docutils literal notranslate"><span class="pre">.index</span></code> slot
as the subsetted object or a logical <em>numpy</em> vector.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">b</span> <span class="o">&gt;</span> <span class="mf">0.4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">b</span> <span class="o">&lt;</span> <span class="mf">0.6</span><span class="p">)]</span>
<span></span><span class="c1">## 7    0.55</span>
<span class="c1">## 4    0.42</span>
<span class="c1">## 3    0.48</span>
<span class="c1">## dtype: float64</span>
</pre></div>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">iloc[...]</span></code>, the indexer must be unlabelled, like in, e.g.,
<code class="docutils literal notranslate"><span class="pre">b.loc[i.values]</span></code>.</p>
</div>
</div>
<div class="section" id="dataframe">
<h3><span class="section-number">18.3.2. </span><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#dataframe" title="Permalink to this headline">¶</a></h3>
<p>For data frames,
<code class="docutils literal notranslate"><span class="pre">iloc</span></code> and <code class="docutils literal notranslate"><span class="pre">loc</span></code> can be used too,
but they now require two arguments, serving as row and column
selectors.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;bacon&quot;</span><span class="p">,</span> <span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="s2">&quot;eggs&quot;</span><span class="p">,</span> <span class="s2">&quot;sausage&quot;</span><span class="p">],</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
<span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>And now:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;u&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;u&quot;</span><span class="p">:</span><span class="s2">&quot;w&quot;</span><span class="p">]</span>
<span></span><span class="c1">##       u     v        w</span>
<span class="c1">## a  0.70  0.32     spam</span>
<span class="c1">## d  0.55  1.98     eggs</span>
<span class="c1">## e  0.72 -1.62  sausage</span>
</pre></div>
</div>
<p>selects the rows where the values in the <code class="docutils literal notranslate"><span class="pre">u</span></code>
column are greater than 0.5 and then
returns all columns between <code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">w</span></code>.</p>
<p>Furthermore,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">]]</span>
<span></span><span class="c1">##       u      w</span>
<span class="c1">## a  0.70   spam</span>
<span class="c1">## b  0.29  bacon</span>
<span class="c1">## c  0.23   spam</span>
</pre></div>
</div>
<p>fetches the first 3 rows (by position – <code class="docutils literal notranslate"><span class="pre">iloc</span></code> is necessary)
and then selects two indicated columns.</p>
<p>On a side note, we can write
<code class="docutils literal notranslate"><span class="pre">d.u</span></code> as a shorter version of <code class="docutils literal notranslate"><span class="pre">d.loc[:,</span> <span class="pre">&quot;u&quot;]</span></code>,
but this accessor is not universal: we can check this out by
considering a data frame featuring a column named, e.g., <code class="docutils literal notranslate"><span class="pre">mean</span></code>.</p>
<blockquote>
<div><p><strong>Exercise.</strong> Use <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.drop</span></code>
to select all columns but <code class="docutils literal notranslate"><span class="pre">v</span></code> in <code class="docutils literal notranslate"><span class="pre">d</span></code>.</p>
</div></blockquote>
<blockquote>
<div><p><strong>Exercise.</strong> Use <code class="docutils literal notranslate"><span class="pre">pandas.Series.isin</span></code> (amongst others)
to select all rows with <code class="docutils literal notranslate"><span class="pre">spam</span></code> and <code class="docutils literal notranslate"><span class="pre">bacon</span></code> on the <code class="docutils literal notranslate"><span class="pre">d</span></code>’s menu.</p>
</div></blockquote>
<blockquote>
<div><p><strong>Exercise.</strong>
In the <a class="reference external" href="https://raw.githubusercontent.com/gagolews/teaching_data/master/other/tips.csv"><code class="docutils literal notranslate"><span class="pre">tips</span></code></a> dataset,
select data on male customers where total bill
was in the <em>[10, 20]</em> interval.
Also, select data from Saturday and Sunday with tip greater than
$5 from <code class="docutils literal notranslate"><span class="pre">tips</span></code>.</p>
</div></blockquote>
</div>
<div class="section" id="adding-rows-and-columns">
<h3><span class="section-number">18.3.3. </span>Adding Rows and Columns<a class="headerlink" href="#adding-rows-and-columns" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">loc[...]</span></code> can also used to add new columns to an existing
data frame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;u&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">d</span>
<span></span><span class="c1">##       u     v        w      x       y</span>
<span class="c1">## a  0.70  0.32     spam   True  0.4900</span>
<span class="c1">## b  0.29 -0.05    bacon  False  0.0841</span>
<span class="c1">## c  0.23 -0.20     spam   True  0.0529</span>
<span class="c1">## d  0.55  1.98     eggs  False  0.3025</span>
<span class="c1">## e  0.72 -1.62  sausage   True  0.5184</span>
</pre></div>
</div>
<blockquote>
<div><p><strong>Exercise.</strong> Use <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.insert</span></code>
to add a new column not necessarily at the end of <code class="docutils literal notranslate"><span class="pre">d</span></code>.</p>
</div></blockquote>
<blockquote>
<div><p><strong>Exercise.</strong> Use <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.append</span></code>
to add a few more rows to <code class="docutils literal notranslate"><span class="pre">d</span></code>.</p>
</div></blockquote>
</div>
<div class="section" id="random-sampling">
<h3><span class="section-number">18.3.4. </span>Random Sampling<a class="headerlink" href="#random-sampling" title="Permalink to this headline">¶</a></h3>
<p>As a simple application of what we have covered so far,
let us consider the case of randomly sampling a number of rows
from an existing data frame.</p>
<p>For the most basic use cases, we can use the
<code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.sample</span></code> method. It includes scenarios
such as:</p>
<ul class="simple">
<li><p>randomly select 5 rows, without replacement,</p></li>
<li><p>randomly select 20% rows, with replacement,</p></li>
<li><p>randomly rearrange all the rows.</p></li>
</ul>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">body</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/gagolews/&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;teaching_data/master/marek/nhanes_adult_female_bmx_2020.csv&quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
<span class="n">body</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>  <span class="c1"># 5 random rows without replacement</span>
<span></span><span class="c1">##       BMXWT  BMXHT  BMXARML  BMXLEG  BMXARMC  BMXHIP  BMXWAIST</span>
<span class="c1">## 4214   58.4  156.2     35.2    34.7     27.2    99.5      77.5</span>
<span class="c1">## 3361   73.7  161.0     36.5    34.5     29.0   107.6      98.2</span>
<span class="c1">## 3759   61.4  164.6     37.5    40.4     26.9    93.5      84.4</span>
<span class="c1">## 3733  120.4  158.8     33.5    34.6     40.5   147.2     129.3</span>
<span class="c1">## 1121  123.5  157.5     35.5    29.0     50.5   143.0     136.4</span>
</pre></div>
</div>
<p>Note the <code class="docutils literal notranslate"><span class="pre">random_state</span></code> argument which controls the seed
of the random number generator so that we get
reproducible results.
Alternatively, we could call <code class="docutils literal notranslate"><span class="pre">numpy.random.seed</span></code>.</p>
<blockquote>
<div><p><strong>Exercise.</strong> Show how the 3 aforementioned scenarios
can be implemented manually using <code class="docutils literal notranslate"><span class="pre">iloc[...]</span></code>
and <code class="docutils literal notranslate"><span class="pre">numpy.random.permutation</span></code>
or <code class="docutils literal notranslate"><span class="pre">numpy.random.choice</span></code>.</p>
</div></blockquote>
<p>In machine learning practice, as we shall
see later, we are used to
training and evaluating machine learning models
on different (mutually disjoint) subsets of the whole data frame.</p>
<p>For instance, we might be interested in performing the
so-called <em>train/test split</em>, where 80% (or 60% or 70%) of the
randomly selected rows would constitute the first
new data frame and the remaining 20% (or 40% or 30%)
would go to the second one.</p>
<p>Given a data frame like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># this is just an example</span>
<span class="n">x</span>
<span></span><span class="c1">##    BMXWT  BMXHT  BMXARML  BMXLEG  BMXARMC  BMXHIP  BMXWAIST</span>
<span class="c1">## 0   97.1  160.2     34.7    40.8     35.8   126.1     117.9</span>
<span class="c1">## 1   91.1  152.7     33.5    33.0     38.5   125.5     103.1</span>
<span class="c1">## 2   73.0  161.2     37.4    38.0     31.8   106.2      92.0</span>
<span class="c1">## 3   61.7  157.4     38.0    34.7     29.0   101.0      90.5</span>
<span class="c1">## 4   55.4  154.6     34.6    34.0     28.3    92.5      73.2</span>
<span class="c1">## 5   62.0  144.7     32.5    34.2     29.8   106.7      84.8</span>
<span class="c1">## 6   66.2  166.5     37.5    37.6     32.0    96.3      95.7</span>
<span class="c1">## 7   75.9  154.5     35.4    37.6     32.7   107.7      98.7</span>
<span class="c1">## 8   77.2  159.2     38.5    40.5     35.7   102.0      97.5</span>
<span class="c1">## 9   91.6  174.5     36.1    45.9     35.2   121.3     100.3</span>
</pre></div>
</div>
<p>one way to perform the aforementioned split is to
generate a random permutation
of the set of row indices:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>  <span class="c1"># reproducibility matters</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">idx</span>
<span></span><span class="c1">## array([4, 0, 7, 5, 8, 3, 1, 6, 9, 2])</span>
</pre></div>
</div>
<p>And then to pick the first 80% of these indices to construct
the data frame number one:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:</span><span class="n">k</span><span class="p">],</span> <span class="p">:]</span>
<span></span><span class="c1">##    BMXWT  BMXHT  BMXARML  BMXLEG  BMXARMC  BMXHIP  BMXWAIST</span>
<span class="c1">## 4   55.4  154.6     34.6    34.0     28.3    92.5      73.2</span>
<span class="c1">## 0   97.1  160.2     34.7    40.8     35.8   126.1     117.9</span>
<span class="c1">## 7   75.9  154.5     35.4    37.6     32.7   107.7      98.7</span>
<span class="c1">## 5   62.0  144.7     32.5    34.2     29.8   106.7      84.8</span>
<span class="c1">## 8   77.2  159.2     38.5    40.5     35.7   102.0      97.5</span>
<span class="c1">## 3   61.7  157.4     38.0    34.7     29.0   101.0      90.5</span>
<span class="c1">## 1   91.1  152.7     33.5    33.0     38.5   125.5     103.1</span>
<span class="c1">## 6   66.2  166.5     37.5    37.6     32.0    96.3      95.7</span>
</pre></div>
</div>
<p>and the remaining ones to generate the second dataset:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">k</span><span class="p">:],</span> <span class="p">:]</span>
<span></span><span class="c1">##    BMXWT  BMXHT  BMXARML  BMXLEG  BMXARMC  BMXHIP  BMXWAIST</span>
<span class="c1">## 9   91.6  174.5     36.1    45.9     35.2   121.3     100.3</span>
<span class="c1">## 2   73.0  161.2     37.4    38.0     31.8   106.2      92.0</span>
</pre></div>
</div>
<blockquote>
<div><p><strong>Exercise.</strong>
In the <a class="reference external" href="https://raw.githubusercontent.com/gagolews/teaching_data/master/other/wine_quality_all.csv"><code class="docutils literal notranslate"><span class="pre">wine_quality_all</span></code></a> dataset,
leave out all but the white wines.
Partition the resulting data frame randomly into three data frames:
<code class="docutils literal notranslate"><span class="pre">wines_train</span></code> (60% of the rows),
<code class="docutils literal notranslate"><span class="pre">wines_validate</span></code> (another 20% of the rows),
and <code class="docutils literal notranslate"><span class="pre">wines_test</span></code> (the remaining 20%).</p>
</div></blockquote>
<blockquote>
<div><p><strong>Exercise.</strong> Consider the white wines dataset again.
Write a function <code class="docutils literal notranslate"><span class="pre">kfold</span></code> which takes
a data frame <code class="docutils literal notranslate"><span class="pre">x</span></code> and an integer <em>k&gt;1</em> on input.
Return a list of data frames resulting
in randomly splitting <code class="docutils literal notranslate"><span class="pre">x</span></code> into <em>k</em> disjoint chunks of
equal (or almost equal if that is not possible) sizes.</p>
</div></blockquote>
</div>
<div class="section" id="hierarchical-indices">
<h3><span class="section-number">18.3.5. </span>Hierarchical Indices (*)<a class="headerlink" href="#hierarchical-indices" title="Permalink to this headline">¶</a></h3>
<p>Consider the following <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object
with a hierarchical index:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">year</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">2024</span><span class="p">,</span> <span class="mi">2025</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span>
    <span class="n">quarter</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Q1&quot;</span><span class="p">,</span> <span class="s2">&quot;Q2&quot;</span><span class="p">,</span> <span class="s2">&quot;Q3&quot;</span><span class="p">,</span> <span class="s2">&quot;Q4&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">))</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;quarter&quot;</span><span class="p">])</span>
<span class="n">d</span>
<span></span><span class="c1">##               data</span>
<span class="c1">## year quarter      </span>
<span class="c1">## 2023 Q1       0.70</span>
<span class="c1">##      Q2       0.29</span>
<span class="c1">##      Q3       0.23</span>
<span class="c1">##      Q4       0.55</span>
<span class="c1">## 2024 Q1       0.72</span>
<span class="c1">##      Q2       0.42</span>
<span class="c1">##      Q3       0.98</span>
<span class="c1">##      Q4       0.68</span>
<span class="c1">## 2025 Q1       0.48</span>
<span class="c1">##      Q2       0.39</span>
<span class="c1">##      Q3       0.34</span>
<span class="c1">##      Q4       0.73</span>
</pre></div>
</div>
<p>The index has both levels named, but this is
purely for aesthetic reasons.</p>
<p>Indexing using <code class="docutils literal notranslate"><span class="pre">loc[...]</span></code> by default relates to the
first level of the hierarchy:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2023</span><span class="p">,</span> <span class="p">:]</span>
<span></span><span class="c1">##          data</span>
<span class="c1">## quarter      </span>
<span class="c1">## Q1       0.70</span>
<span class="c1">## Q2       0.29</span>
<span class="c1">## Q3       0.23</span>
<span class="c1">## Q4       0.55</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">2025</span><span class="p">],</span> <span class="p">:]</span>
<span></span><span class="c1">##               data</span>
<span class="c1">## year quarter      </span>
<span class="c1">## 2023 Q1       0.70</span>
<span class="c1">##      Q2       0.29</span>
<span class="c1">##      Q3       0.23</span>
<span class="c1">##      Q4       0.55</span>
<span class="c1">## 2025 Q1       0.48</span>
<span class="c1">##      Q2       0.39</span>
<span class="c1">##      Q3       0.34</span>
<span class="c1">##      Q4       0.73</span>
</pre></div>
</div>
<p>To access deeper levels, we can use tuples as indexers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">2023</span><span class="p">,</span> <span class="s2">&quot;Q1&quot;</span><span class="p">),</span> <span class="p">:]</span>
<span></span><span class="c1">## data    0.7</span>
<span class="c1">## Name: (2023, Q1), dtype: float64</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[[(</span><span class="mi">2023</span><span class="p">,</span> <span class="s2">&quot;Q1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2024</span><span class="p">,</span> <span class="s2">&quot;Q3&quot;</span><span class="p">)],</span> <span class="p">:]</span>
<span></span><span class="c1">##               data</span>
<span class="c1">## year quarter      </span>
<span class="c1">## 2023 Q1       0.70</span>
<span class="c1">## 2024 Q3       0.98</span>
</pre></div>
</div>
<p>In certain scenarios, though, it will probably be much easier
to subset a hierarchical index
by using <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> and <code class="docutils literal notranslate"><span class="pre">set_index</span></code> creatively
(together with <code class="docutils literal notranslate"><span class="pre">loc[...]</span></code> and <code class="docutils literal notranslate"><span class="pre">pandas.Series.isin</span></code>, etc.).</p>
<p>Also, we should note that the “<code class="docutils literal notranslate"><span class="pre">:</span></code>” operator
for slicing can be used only <em>directly</em> within square brackets,
but we can always use the <code class="docutils literal notranslate"><span class="pre">slice</span></code> constructor to create them
from within any context:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="p">[</span><span class="s2">&quot;Q1&quot;</span><span class="p">,</span> <span class="s2">&quot;Q3&quot;</span><span class="p">]),</span> <span class="p">:]</span>  <span class="c1"># `:`, [&quot;Q1&quot;, &quot;Q3&quot;]</span>
<span></span><span class="c1">##               data</span>
<span class="c1">## year quarter      </span>
<span class="c1">## 2023 Q1       0.70</span>
<span class="c1">##      Q3       0.23</span>
<span class="c1">## 2024 Q1       0.72</span>
<span class="c1">##      Q3       0.98</span>
<span class="c1">## 2025 Q1       0.48</span>
<span class="c1">##      Q3       0.34</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;Q2&quot;</span><span class="p">,</span> <span class="s2">&quot;Q3&quot;</span><span class="p">)),</span> <span class="p">:]</span>  <span class="c1"># ::-1, &quot;Q2&quot;:&quot;Q3&quot;</span>
<span></span><span class="c1">##               data</span>
<span class="c1">## year quarter      </span>
<span class="c1">## 2025 Q3       0.34</span>
<span class="c1">##      Q2       0.39</span>
<span class="c1">## 2024 Q3       0.98</span>
<span class="c1">##      Q2       0.42</span>
<span class="c1">## 2023 Q3       0.23</span>
<span class="c1">##      Q2       0.29</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="further-reading">
<h2><span class="section-number">18.4. </span>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this headline">¶</a></h2>
<p>McKinney W. <em>Python for Data Analysis: Data Wrangling with Pandas, NumPy, and IPython</em>, O’Reilly, 2017.</p>
</div>
<div class="section" id="questions">
<h2><span class="section-number">18.5. </span>Questions<a class="headerlink" href="#questions" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Why learning <em>numpy</em> is crucial when someone wants to become
a proficient user of <em>pandas</em>?</p></li>
<li><p>What is the difference between <code class="docutils literal notranslate"><span class="pre">iloc[...]</span></code> and <code class="docutils literal notranslate"><span class="pre">loc[...]</span></code>?</p></li>
<li><p>Why applying the index operator <code class="docutils literal notranslate"><span class="pre">[...]</span></code> directly on a
<code class="docutils literal notranslate"><span class="pre">Series</span></code> or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object is not necessarily a good idea?</p></li>
<li><p>What is the difference between <code class="docutils literal notranslate"><span class="pre">.index</span></code>, <code class="docutils literal notranslate"><span class="pre">Index</span></code>, and <code class="docutils literal notranslate"><span class="pre">.columns</span></code>?</p></li>
<li><p>How to compute the arithmetic mean and median
of all the numeric columns in a data frame, using
a single line of code?</p></li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="430-reshape.html" class="btn btn-neutral float-right" title="19. Reshaping and Fusing Datasets" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="410-dataframe.html" class="btn btn-neutral float-left" title="17. Introduction to Data Frames in pandas" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2015-2022, Marek Gagolewski. Licensed under CC BY-NC-ND 4.0.
      <span class="lastupdated">
        Last updated on 2022-03-27T18:03:39+1100.
      </span>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a>
    and a customised <a href="https://github.com/rtfd/sphinx_rtd_theme">rtd</a> theme.
    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>