<!DOCTYPE html>


<html class="writer-html5" lang="en" >
<!-- Copyright (C) 2020-2021, Marek Gagolewski <https://www.gagolewski.com> -->

<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>22. Database Access &mdash; Minimalist Data Wrangling with Python by Marek Gagolewski</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/proof.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  

  
  

  
    <link rel="canonical" href="https://datawranglingpy.gagolewski.com/chapter/460-sql.html" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/proof.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="23. Working with Text Data" href="510-text.html" />
    <link rel="prev" title="21. Outliers, Missing, Censored, and Incorrect Data" href="450-missingness.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html"> Minimalist Data Wrangling with Python [DRAFTv0.1]
          

          
          </a>

          <div class="version">
          by <a style="color: inherit" href="https://www.gagolewski.com">Marek Gagolewski</a>
          </div>

<!--
          
            
            
              <div class="version">
                by Marek Gagolewski
              </div>
            
          
-->

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search phrase..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Start Here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="000-preface.html">Preface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introducing Python</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="110-jupyter.html">1. Getting Started with Python and JupyterLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="120-scalar.html">2. Scalar Types in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="130-sequential.html">3. Sequential and Other Types in Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Unidimensional Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="210-vector.html">4. Introduction to Vectors in <em>numpy</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="220-histogram.html">5. Inspecting the Distribution of Numeric Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="230-aggregate.html">6. Descriptive Statistics for Continuous Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="240-transform-uni.html">7. Transforming and Filtering Continuous Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="250-distribution-uni.html">8. Continuous Probability Distributions (**)</a></li>
<li class="toctree-l1"><a class="reference internal" href="260-categorical-uni.html">9. Handling Categorical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="270-time-uni.html">10. Processing Time Series</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Multidimensional Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="310-matrix.html">11. Introduction to Matrices in <em>numpy</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="320-transform-multi.html">12. Transforming, Aggregating, and Filtering Multidimensional Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="330-categorical-multi.html">13. Multivariate Categorical and Relational Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="330-visualise-multi.html">14. Visualising Multidimensional Data and Measuring Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="350-time-multi.html">15. Multidimensional Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="360-image.html">16. Notes on Signal Processing (Audio, Image, Video)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Heterogeneous Data</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="410-dataframe.html">17. Introduction to Data Frames in <em>pandas</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="420-transform-hetero.html">18. Basic Operations on Data Frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="430-reshape.html">19. Reshaping and Fusing Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="440-groupby.html">20. Observation Grouping</a></li>
<li class="toctree-l1"><a class="reference internal" href="450-missingness.html">21. Outliers, Missing, Censored, and Incorrect Data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">22. Database Access</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example-database">22.1. Example Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exporting-data">22.2. Exporting Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-sql-queries">22.3. Example SQL Queries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#filtering">22.3.1. Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ordering">22.3.2. Ordering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#removing-duplicates">22.3.3. Removing Duplicates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#grouping-and-aggregating">22.3.4. Grouping and Aggregating</a></li>
<li class="toctree-l3"><a class="reference internal" href="#joining">22.3.5. Joining</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#closing-the-database-connection">22.4. Closing the Database Connection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#further-reading">22.5. Further Reading</a></li>
<li class="toctree-l2"><a class="reference internal" href="#questions">22.6. Questions</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Text Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="510-text.html">23. Working with Text Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="520-regex.html">24. Regular Expressions (*)</a></li>
<li class="toctree-l1"><a class="reference internal" href="530-webscrape.html">25. Fetching and Cleaning Text Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="999-bibliography.html">Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/datawranglingpy/blob/master/CODE_OF_CONDUCT.md">Report Bugs or Typos</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.gagolewski.com">Author</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Minimalist Data Wrangling with Python [DRAFTv0.1]</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><span class="section-number">22. </span>Database Access</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="510-text.html" class="btn btn-neutral float-right" title="23. Working with Text Data" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="450-missingness.html" class="btn btn-neutral float-left" title="21. Outliers, Missing, Censored, and Incorrect Data" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="database-access">
<span id="chap-sql"></span><h1><span class="section-number">22. </span>Database Access<a class="headerlink" href="#database-access" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p><em>Minimalist Data Wrangling with Python</em> is a very-early-and-rough-draft
of the forthcoming (ETA 2023) textbook by
<a class="reference external" href="https://www.gagolewski.com">Marek Gagolewski</a>.
It is distributed in the hope that it will be useful.
If you detect any bugs or typos, please share them by
<a class="reference external" href="https://github.com/gagolews/datawranglingpy/blob/master/CODE_OF_CONDUCT.md">email</a>.
Although available online, this is a whole course, and should be read
from the beginning to the end. In particular, refer to the Preface for
general introductory remarks. Enjoy.</p>
</div></blockquote>
<p><em>Pandas</em> is convenient for working with data that fit into memory
and which can be stored in individual CSV files.
However, larger information banks, possibly in a shared environment,
will often be made available to us via relational (structured) databases
such us PostgreSQL or MariaDB, or a wide range of commercial products.</p>
<p>Most commonly, we will be using SQL (structured query language)
to express the data chunks we need for analysis,
fetching them from the database driver,
and importing them to a <em>pandas</em> data frame
to perform the already well-known operations.</p>
<p>Below we give a quick introduction to the basics of SQL
using <a class="reference external" href="https://sqlite.org"><em>SQLite</em></a>, which is a lightweight,
flat-file, and server-less database management system.
Overall, <em>SQLite</em> is very good for working with data of even
hundreds or thousands of gigabytes in size that fit on
a single computer’s disk (making it a good choice for
playing with our own data science projects or prototyping
more complex solutions).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite3</span>
</pre></div>
</div>
<blockquote>
<div><p><strong>Important.</strong> The syntax of SQL is very readable – it is modelled
after the natural (English) language. In this introduction, we merely
assume that we wish to learn how to read the basic SQL queries,
not to write our own. The latter should be covered by a separate
course on databases.</p>
</div></blockquote>
<p>Other packages we use below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.notebook_repr_html&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># disable &quot;rich&quot; output</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="example-database">
<h2><span class="section-number">22.1. </span>Example Database<a class="headerlink" href="#example-database" title="Permalink to this headline">¶</a></h2>
<p>In the course of this section, we will be working with a simplified data dump
of the Q&amp;A site <a class="reference external" href="http://travel.stackexchange.com">http://travel.stackexchange.com</a> which we have downloaded
from <a class="reference external" href="https://archive.org/details/stackexchange">https://archive.org/details/stackexchange</a> on October 31, 2017.
We have pre-processed the datasets and made them available at
<a class="reference external" href="https://github.com/gagolews/teaching_data/tree/master/travel_stackexchange_com_2017">https://github.com/gagolews/teaching_data/tree/master/travel_stackexchange_com_2017</a>.</p>
<blockquote>
<div><p><strong>Exercise.</strong> Before continuing, make yourself familiar with
<a class="reference external" href="http://travel.stackexchange.com">http://travel.stackexchange.com</a> .</p>
</div></blockquote>
<p>For example, <code class="docutils literal notranslate"><span class="pre">Tags</span></code> gives, amongst others,
topic categories (<code class="docutils literal notranslate"><span class="pre">TagName</span></code>) and how many questions mention them (<code class="docutils literal notranslate"><span class="pre">Count</span></code>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Tags</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/gagolews/&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;teaching_data/master/travel_stackexchange_com_2017/Tags.csv.gz&quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
<span class="n">Tags</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span></span><span class="c1">##    Count  ExcerptPostId  Id    TagName  WikiPostId</span>
<span class="c1">## 0    104         2138.0   1   cruising      2137.0</span>
<span class="c1">## 1     43          357.0   2  caribbean       356.0</span>
<span class="c1">## 2     43          319.0   4  vacations       318.0</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Users</span></code> provides information on the registered users.
In particular, the <code class="docutils literal notranslate"><span class="pre">Id</span></code> column uniquely identifies each member.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Users</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/gagolews/&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;teaching_data/master/travel_stackexchange_com_2017/Users.csv.gz&quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
<span class="n">Users</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span></span><span class="c1">##    AccountId   Age             CreationDate   DisplayName  ...            Location  Reputation UpVotes Views</span>
<span class="c1">## 0       -1.0   NaN  2011-06-21T15:16:44.253     Community  ...  on the server farm         1.0  2472.0   0.0</span>
<span class="c1">## 1        2.0  40.0  2011-06-21T20:10:03.720  Geoff Dalgas  ...       Corvallis, OR       101.0     1.0  31.0</span>
<span class="c1">## 2     7598.0  32.0  2011-06-21T20:11:02.490   Nick Craver  ...   Winston-Salem, NC       101.0     1.0  14.0</span>
<span class="c1">## </span>
<span class="c1">## [3 rows x 11 columns]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Badges</span></code> recall all rewards given to the users (<code class="docutils literal notranslate"><span class="pre">UserId</span></code>)
for their engaging in various praiseworthy activities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Badges</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/gagolews/&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;teaching_data/master/travel_stackexchange_com_2017/Badges.csv.gz&quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
<span class="n">Badges</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span></span><span class="c1">##    Class                     Date  Id            Name  TagBased  UserId</span>
<span class="c1">## 0      3  2011-06-21T20:16:48.910   1  Autobiographer     False       2</span>
<span class="c1">## 1      3  2011-06-21T20:16:48.910   2  Autobiographer     False       3</span>
<span class="c1">## 2      3  2011-06-21T20:16:48.910   3  Autobiographer     False       4</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Posts</span></code> (note again that <code class="docutils literal notranslate"><span class="pre">Id</span></code> is the unique identifier of each record
in every data frame) lists all the questions and answers (the latter
don’t have <code class="docutils literal notranslate"><span class="pre">ParentId</span></code> set to <code class="docutils literal notranslate"><span class="pre">NaN</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Posts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/gagolews/&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;teaching_data/master/travel_stackexchange_com_2017/Posts.csv.gz&quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
<span class="n">Posts</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span></span><span class="c1">##    AcceptedAnswerId  AnswerCount  ...                                              Title  ViewCount</span>
<span class="c1">## 0             393.0          4.0  ...       What are some Caribbean cruises for October?      419.0</span>
<span class="c1">## 1               NaN          7.0  ...  How can I find a guide that will take me safel...     1399.0</span>
<span class="c1">## 2               NaN          NaN  ...                                                NaN        NaN</span>
<span class="c1">## </span>
<span class="c1">## [3 rows x 17 columns]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Votes</span></code> list all the up-votes (<code class="docutils literal notranslate"><span class="pre">VoteTypeId</span></code> equal to 2)
and down-votes (<code class="docutils literal notranslate"><span class="pre">VoteTypeId</span></code> of 3)
to all the posts. For privacy reasons, all <code class="docutils literal notranslate"><span class="pre">UserId</span></code>s are missing.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Votes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/gagolews/&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;teaching_data/master/travel_stackexchange_com_2017/Votes.csv.gz&quot;</span><span class="p">,</span>
    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
<span class="n">Votes</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span></span><span class="c1">##    BountyAmount             CreationDate  Id  PostId  UserId  VoteTypeId</span>
<span class="c1">## 0           NaN  2011-06-21T00:00:00.000   1       1     NaN           2</span>
<span class="c1">## 1           NaN  2011-06-21T00:00:00.000   2       1     NaN           2</span>
<span class="c1">## 2           NaN  2011-06-21T00:00:00.000   3       2     NaN           2</span>
</pre></div>
</div>
<blockquote>
<div><p><strong>Exercise.</strong>
See the <a class="reference external" href="https://github.com/gagolews/teaching_data/blob/master/travel_stackexchange_com/README.md"><code class="docutils literal notranslate"><span class="pre">README</span></code></a> file for the detailed description
of each column.</p>
</div></blockquote>
</div>
<div class="section" id="exporting-data">
<h2><span class="section-number">22.2. </span>Exporting Data<a class="headerlink" href="#exporting-data" title="Permalink to this headline">¶</a></h2>
<p>Let us establish a connection with the to-be
<em>SQLite</em> database. In our case,
that will be an ordinary file stored on the computer’s disk
(here, we use a temporary file):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tempfile</span><span class="o">,</span> <span class="nn">os.path</span>
<span class="n">dbfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(),</span> <span class="s2">&quot;travel.db&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dbfile</span><span class="p">)</span>
<span></span><span class="c1">## /tmp/tmpwu9wh_sg/travel.db</span>
</pre></div>
</div>
<p>And now:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dbfile</span><span class="p">)</span>
</pre></div>
</div>
<p>We are thus “connected”. The database might now be queried:
new tables can be added, new records inserted, and
information fetched.</p>
<blockquote>
<div><p><strong>Important.</strong> At the end, we should not forget
about the call to <code class="docutils literal notranslate"><span class="pre">conn.close()</span></code>.</p>
</div></blockquote>
<p>We already have our data in form of <em>pandas</em> data frames,
therefore exporting them to the database is straightforward.
All we have to do is to perform
a bunch of calls to the <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.to_sql</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Tags</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;Tags&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Users</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;Users&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Badges</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;Badges&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Posts</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;Posts&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Votes</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;Votes&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span></span><span class="c1">## 1743</span>
<span class="c1">## 44203</span>
<span class="c1">## 108812</span>
<span class="c1">## 72181</span>
<span class="c1">## 566062</span>
</pre></div>
</div>
<p>(*) Note that it is possible to export data that do not fit into memory
by reading them in chunks of considerable, but not too large, sizes.
In particular <code class="docutils literal notranslate"><span class="pre">pandas.read_csv</span></code> has the <code class="docutils literal notranslate"><span class="pre">nrows</span></code> argument that lets us
read a number of rows from a file buffer; see <code class="docutils literal notranslate"><span class="pre">help(&quot;open&quot;)</span></code>.
Then, <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.to_sql(...,</span> <span class="pre">if_exists=&quot;append&quot;)</span></code> can
be used to append new rows to an existing table.</p>
<p>(**) Exporting data is of course  possible without <em>pandas</em> as well, e.g.,
when data are to be imported from XML or JSON files and
processed manually, row by row.
Intermediate-level SQL users can call <code class="docutils literal notranslate"><span class="pre">conn.execute(&quot;CREATE</span> <span class="pre">TABLE</span> <span class="pre">t...&quot;)</span></code>,
<code class="docutils literal notranslate"><span class="pre">conn.executemany(&quot;INSERT</span> <span class="pre">INTO</span> <span class="pre">t</span> <span class="pre">VALUES(?,</span> <span class="pre">?,</span> <span class="pre">?)&quot;,</span> <span class="pre">l)</span></code> followed by
<code class="docutils literal notranslate"><span class="pre">conn.commit()</span></code> to create a new table (here: named <code class="docutils literal notranslate"><span class="pre">t</span></code>) populated
by a list of records (e.g., in form of tuples or <em>numpy</em> vectors).
For more details, see the <a class="reference external" href="https://docs.python.org/3/library/sqlite3.html">manual</a> of the <code class="docutils literal notranslate"><span class="pre">sqlite3</span></code> package.</p>
</div>
<div class="section" id="example-sql-queries">
<h2><span class="section-number">22.3. </span>Example SQL Queries<a class="headerlink" href="#example-sql-queries" title="Permalink to this headline">¶</a></h2>
<p>We can use <em>pandas</em> to fetch the results generated
by executing any SQL query, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT * FROM Tags LIMIT 3</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span></span><span class="c1">##    Count  ExcerptPostId  Id    TagName  WikiPostId</span>
<span class="c1">## 0    104         2138.0   1   cruising      2137.0</span>
<span class="c1">## 1     43          357.0   2  caribbean       356.0</span>
<span class="c1">## 2     43          319.0   4  vacations       318.0</span>
</pre></div>
</div>
<p>Fetches all columns (<code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span></code>) and
the first 3 rows (<code class="docutils literal notranslate"><span class="pre">LIMIT</span> <span class="pre">3</span></code>) from the <code class="docutils literal notranslate"><span class="pre">Tags</span></code> table.</p>
<blockquote>
<div><p><strong>Exercise.</strong> For the above and all the remaining SQL queries,
write the equivalent Python code using <em>pandas</em> functions and methods
that generates exactly the same result. In each case, there might be
more than one equally fine solution.</p>
</div></blockquote>
<p>For instance, here is the reference result:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">res1a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT * FROM Tags LIMIT 3</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
<p>Our example equivalent <em>pandas</em> implementation of the above operation
might look like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">res1b</span> <span class="o">=</span> <span class="n">Tags</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>To verify if the results are identical, we can call:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">res1a</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">res1b</span><span class="p">)</span>
<span></span><span class="c1">## True</span>
</pre></div>
</div>
<div class="section" id="filtering">
<h3><span class="section-number">22.3.1. </span>Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h3>
<p>Fetch all tag data for tags whose name contain <code class="docutils literal notranslate"><span class="pre">&quot;europe&quot;</span></code> as substring:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT * FROM Tags WHERE TagName LIKE &#39;</span><span class="si">%e</span><span class="s2">urope%&#39;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span></span><span class="c1">##    Count  ExcerptPostId    Id           TagName  WikiPostId</span>
<span class="c1">## 0    681          286.0    30            europe       285.0</span>
<span class="c1">## 1     27         2384.0   174    eastern-europe      2383.0</span>
<span class="c1">## 2     12         6403.0   512  southeast-europe      6402.0</span>
<span class="c1">## 3     20         4513.0   669    central-europe      4512.0</span>
<span class="c1">## 4     36        16392.0  1950    western-europe     16391.0</span>
</pre></div>
</div>
<p><em>Hint: use <code class="docutils literal notranslate"><span class="pre">Tags.TagName.str.contains(&quot;europe&quot;)</span></code> to obtain the
same result with</em> pandas.</p>
<p>From <code class="docutils literal notranslate"><span class="pre">Tags</span></code>, select two columns <code class="docutils literal notranslate"><span class="pre">TagName</span></code> and <code class="docutils literal notranslate"><span class="pre">Count</span></code>
and rows for which <code class="docutils literal notranslate"><span class="pre">TagName</span></code> is equal to one of the three choices provided.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT TagName, Count</span>
<span class="s2">    FROM Tags</span>
<span class="s2">    WHERE TagName IN (&#39;poland&#39;, &#39;australia&#39;, &#39;china&#39;)</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span></span><span class="c1">##      TagName  Count</span>
<span class="c1">## 0      china    443</span>
<span class="c1">## 1  australia    411</span>
<span class="c1">## 2     poland    139</span>
</pre></div>
</div>
<p><em>Hint: use <code class="docutils literal notranslate"><span class="pre">Tags.TagName.isin</span></code>.</em></p>
<p>Select a number of columns from <code class="docutils literal notranslate"><span class="pre">Posts</span></code>
whose rows fulfil given conditions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT Title, Score, ViewCount, FavoriteCount</span>
<span class="s2">    FROM Posts</span>
<span class="s2">    WHERE PostTypeId=1 AND</span>
<span class="s2">        ViewCount&gt;=10000 AND</span>
<span class="s2">        FavoriteCount BETWEEN 35 AND 100</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span></span><span class="c1">##                                                Title  Score  ViewCount  FavoriteCount</span>
<span class="c1">## 0  When traveling to a country with a different c...    136    16838.0           35.0</span>
<span class="c1">## 1         How can I do a &quot;broad&quot; search for flights?     95    33554.0           49.0</span>
<span class="c1">## 2  Tactics to avoid getting harassed by corrupt p...    156    13220.0           42.0</span>
<span class="c1">## 3  Flight tickets: buy two weeks before even duri...    109    49440.0           36.0</span>
<span class="c1">## 4  OK we&#39;re all adults here, so really, how on ea...    306    73808.0           79.0</span>
<span class="c1">## 5  How to intentionally get denied entry to the U...    219    63873.0           53.0</span>
<span class="c1">## 6  How do you know if Americans genuinely/literal...    254    30312.0           79.0</span>
<span class="c1">## 7  OK, we are all adults here, so what is a bidet...    140    52265.0           38.0</span>
<span class="c1">## 8          How to cope with too slow Wi-Fi at hotel?     82    16380.0           41.0</span>
</pre></div>
</div>
<p>Note that the SQL syntax is very readable, hence
no explanations are needed.</p>
</div>
<div class="section" id="ordering">
<h3><span class="section-number">22.3.2. </span>Ordering<a class="headerlink" href="#ordering" title="Permalink to this headline">¶</a></h3>
<p>Select the <code class="docutils literal notranslate"><span class="pre">Title</span></code> and <code class="docutils literal notranslate"><span class="pre">Score</span></code> columns from <code class="docutils literal notranslate"><span class="pre">Posts</span></code>
where <code class="docutils literal notranslate"><span class="pre">ParentId</span></code> is missing (i.e., the post is actually a question)
and <code class="docutils literal notranslate"><span class="pre">Title</span></code> is well-defined;
then, sort the result by the <code class="docutils literal notranslate"><span class="pre">Score</span></code> column, decreasingly
(descending order); finally, return only first 5 rows (e.g.,
top 5 scoring questions):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT Title, Score</span>
<span class="s2">    FROM Posts</span>
<span class="s2">    WHERE ParentId IS NULL AND Title IS NOT NULL</span>
<span class="s2">    ORDER BY Score DESC</span>
<span class="s2">    LIMIT 5</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span></span><span class="c1">##                                                Title  Score</span>
<span class="c1">## 0  OK we&#39;re all adults here, so really, how on ea...    306</span>
<span class="c1">## 1  How do you know if Americans genuinely/literal...    254</span>
<span class="c1">## 2  How to intentionally get denied entry to the U...    219</span>
<span class="c1">## 3  Why are airline passengers asked to lift up wi...    210</span>
<span class="c1">## 4                       Why prohibit engine braking?    178</span>
</pre></div>
</div>
<p><em>Hint: use <code class="docutils literal notranslate"><span class="pre">Posts.sort_values</span></code>.</em></p>
</div>
<div class="section" id="removing-duplicates">
<h3><span class="section-number">22.3.3. </span>Removing Duplicates<a class="headerlink" href="#removing-duplicates" title="Permalink to this headline">¶</a></h3>
<p>Get all unique badge names for the user with <code class="docutils literal notranslate"><span class="pre">Id=23</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT DISTINCT Name</span>
<span class="s2">    FROM Badges</span>
<span class="s2">    WHERE UserId=23</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span></span><span class="c1">##                 Name</span>
<span class="c1">## 0          Supporter</span>
<span class="c1">## 1            Student</span>
<span class="c1">## 2            Teacher</span>
<span class="c1">## 3            Scholar</span>
<span class="c1">## 4               Beta</span>
<span class="c1">## 5      Nice Question</span>
<span class="c1">## 6             Editor</span>
<span class="c1">## 7        Nice Answer</span>
<span class="c1">## 8           Yearling</span>
<span class="c1">## 9   Popular Question</span>
<span class="c1">## 10        Taxonomist</span>
<span class="c1">## 11  Notable Question</span>
</pre></div>
</div>
<p><em>Hint: use <code class="docutils literal notranslate"><span class="pre">Posts.drop_duplicates</span></code>.</em></p>
<p>For each badge given to the user with <code class="docutils literal notranslate"><span class="pre">Id=23</span></code>,
get the year it was given and store it in a new column named <code class="docutils literal notranslate"><span class="pre">Year</span></code>.
Then, select are unique pairs <code class="docutils literal notranslate"><span class="pre">(Name,</span> <span class="pre">Year)</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT DISTINCT Name, strftime(&#39;%Y&#39;, Date) AS Year</span>
<span class="s2">    FROM Badges</span>
<span class="s2">    WHERE UserId=23</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span></span><span class="c1">##                 Name  Year</span>
<span class="c1">## 0          Supporter  2011</span>
<span class="c1">## 1            Student  2011</span>
<span class="c1">## 2            Teacher  2011</span>
<span class="c1">## 3            Scholar  2011</span>
<span class="c1">## 4               Beta  2011</span>
<span class="c1">## 5      Nice Question  2011</span>
<span class="c1">## 6             Editor  2012</span>
<span class="c1">## 7        Nice Answer  2012</span>
<span class="c1">## 8           Yearling  2012</span>
<span class="c1">## 9      Nice Question  2012</span>
<span class="c1">## 10     Nice Question  2013</span>
<span class="c1">## 11          Yearling  2013</span>
<span class="c1">## 12  Popular Question  2014</span>
<span class="c1">## 13          Yearling  2014</span>
<span class="c1">## 14        Taxonomist  2014</span>
<span class="c1">## 15  Notable Question  2015</span>
<span class="c1">## 16     Nice Question  2017</span>
</pre></div>
</div>
<p><em>Hint: use <code class="docutils literal notranslate"><span class="pre">Badges.Date.astype(&quot;datetime64&quot;).dt.strftime(&quot;%Y&quot;)</span></code>.</em></p>
</div>
<div class="section" id="grouping-and-aggregating">
<h3><span class="section-number">22.3.4. </span>Grouping and Aggregating<a class="headerlink" href="#grouping-and-aggregating" title="Permalink to this headline">¶</a></h3>
<p>Count how many badges of each type the user with <code class="docutils literal notranslate"><span class="pre">Id=23</span></code> has received.
Also, for each badge type, return the minimal, average, and maximal
receiving year.
Return only the top 4 badges (with respect to the counts).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        Name,</span>
<span class="s2">        COUNT(*) AS Count,</span>
<span class="s2">        MIN(strftime(&#39;%Y&#39;, Date)) AS MinYear,</span>
<span class="s2">        AVG(strftime(&#39;%Y&#39;, Date)) AS MeanYear,</span>
<span class="s2">        MAX(strftime(&#39;%Y&#39;, Date)) AS MaxYear</span>
<span class="s2">    FROM Badges</span>
<span class="s2">    WHERE UserId=23</span>
<span class="s2">    GROUP BY Name</span>
<span class="s2">    ORDER BY Count DESC</span>
<span class="s2">    LIMIT 4</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span></span><span class="c1">##                Name  Count MinYear  MeanYear MaxYear</span>
<span class="c1">## 0     Nice Question      4    2011   2013.25    2017</span>
<span class="c1">## 1          Yearling      3    2012   2013.00    2014</span>
<span class="c1">## 2  Popular Question      3    2014   2014.00    2014</span>
<span class="c1">## 3  Notable Question      2    2015   2015.00    2015</span>
</pre></div>
</div>
<p>Similarly to the above, but now count how many
unique combinations of pairs <code class="docutils literal notranslate"><span class="pre">(Name,</span> <span class="pre">Date</span></code>) are there;
then, return only the rows having <code class="docutils literal notranslate"><span class="pre">Count</span></code> greater than 1
and order the results by <code class="docutils literal notranslate"><span class="pre">Count</span></code> decreasingly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        Name,</span>
<span class="s2">        strftime(&#39;%Y&#39;, Date) AS Year,</span>
<span class="s2">        COUNT(*) AS Count</span>
<span class="s2">    FROM Badges</span>
<span class="s2">    WHERE UserId=23</span>
<span class="s2">    GROUP BY Name, Year</span>
<span class="s2">    HAVING Count &gt; 1</span>
<span class="s2">    ORDER BY Count DESC</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span></span><span class="c1">##                Name  Year  Count</span>
<span class="c1">## 0  Popular Question  2014      3</span>
<span class="c1">## 1  Notable Question  2015      2</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> is performed before <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code>, and <code class="docutils literal notranslate"><span class="pre">HAVING</span></code>
is applied thereafter.</p>
</div>
<div class="section" id="joining">
<h3><span class="section-number">22.3.5. </span>Joining<a class="headerlink" href="#joining" title="Permalink to this headline">¶</a></h3>
<p>Join (merge) <code class="docutils literal notranslate"><span class="pre">Tags</span></code>, <code class="docutils literal notranslate"><span class="pre">Posts</span></code>, and <code class="docutils literal notranslate"><span class="pre">Users</span></code>
for all posts with <code class="docutils literal notranslate"><span class="pre">OwnerUserId</span></code> not equal to <code class="docutils literal notranslate"><span class="pre">-1</span></code> (i.e.,
the tags which were created by “alive” users).
Return the top 5 records with respect to <code class="docutils literal notranslate"><span class="pre">Tags.Count</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT Tags.TagName, Tags.Count, Posts.OwnerUserId,</span>
<span class="s2">        Users.Age, Users.Location, Users.DisplayName</span>
<span class="s2">    FROM Tags</span>
<span class="s2">    JOIN Posts ON Posts.Id=Tags.WikiPostId</span>
<span class="s2">    JOIN Users ON Users.AccountId=Posts.OwnerUserId</span>
<span class="s2">    WHERE OwnerUserId != -1</span>
<span class="s2">    ORDER BY Tags.Count DESC LIMIT 5</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span></span><span class="c1">##          TagName  Count  OwnerUserId   Age          Location       DisplayName</span>
<span class="c1">## 0         canada    802        101.0  34.0     Mumbai, India             hitec</span>
<span class="c1">## 1         europe    681        583.0  35.0  Philadelphia, PA       Adam Tuttle</span>
<span class="c1">## 2  visa-refusals    554       1737.0  34.0      New York, NY  Benjamin Pollack</span>
<span class="c1">## 3      australia    411        101.0  34.0     Mumbai, India             hitec</span>
<span class="c1">## 4  new-york-city    204        101.0  34.0     Mumbai, India             hitec</span>
</pre></div>
</div>
<p>First, create an auxiliary (temporary) table named <code class="docutils literal notranslate"><span class="pre">UpVotesTab</span></code>,
where we store the information about the number of up-votes
(<code class="docutils literal notranslate"><span class="pre">VoteTypeId=2</span></code>) that each post has received.
Then, join (merge) this table with <code class="docutils literal notranslate"><span class="pre">Posts</span></code>
and fetch some details about the 5 questions (<code class="docutils literal notranslate"><span class="pre">PostTypeId=1</span></code>)
with the most up-votes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT UpVotesTab.*, Posts.Title FROM</span>
<span class="s2">    (</span>
<span class="s2">        SELECT PostId, COUNT(*) AS UpVotes</span>
<span class="s2">        FROM Votes</span>
<span class="s2">        WHERE VoteTypeId=2</span>
<span class="s2">        GROUP BY PostId</span>
<span class="s2">    ) AS UpVotesTab</span>
<span class="s2">    JOIN Posts ON UpVotesTab.PostId=Posts.Id</span>
<span class="s2">    WHERE Posts.PostTypeId=1</span>
<span class="s2">    ORDER BY UpVotesTab.UpVotes DESC LIMIT 5</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span></span><span class="c1">##    PostId  UpVotes                                              Title</span>
<span class="c1">## 0    3080      307  OK we&#39;re all adults here, so really, how on ea...</span>
<span class="c1">## 1   38177      254  How do you know if Americans genuinely/literal...</span>
<span class="c1">## 2   24540      221  How to intentionally get denied entry to the U...</span>
<span class="c1">## 3   20207      211  Why are airline passengers asked to lift up wi...</span>
<span class="c1">## 4   96447      178                       Why prohibit engine braking?</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="closing-the-database-connection">
<h2><span class="section-number">22.4. </span>Closing the Database Connection<a class="headerlink" href="#closing-the-database-connection" title="Permalink to this headline">¶</a></h2>
<p>We have said we should not forget about:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>This gives some sense of closure. Such a relief.</p>
</div>
<div class="section" id="further-reading">
<h2><span class="section-number">22.5. </span>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">sqlite3</span></code> package, <a class="reference external" href="https://docs.python.org/3/library/sqlite3.html">https://docs.python.org/3/library/sqlite3.html</a></p>
<p>SQLite – SQL syntax, <a class="reference external" href="https://sqlite.org/lang.html">https://sqlite.org/lang.html</a></p>
</div>
<div class="section" id="questions">
<h2><span class="section-number">22.6. </span>Questions<a class="headerlink" href="#questions" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>What are the benefits of using a SQL-supporting relational
database management system in data science activities?</p></li>
<li><p>(**) How to populate a database with gigabytes of data
read from many CSV files?</p></li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="510-text.html" class="btn btn-neutral float-right" title="23. Working with Text Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="450-missingness.html" class="btn btn-neutral float-left" title="21. Outliers, Missing, Censored, and Incorrect Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2015-2022, Marek Gagolewski. Licensed under CC BY-NC-ND 4.0.
      <span class="lastupdated">
        Last updated on 2022-03-27T18:03:39+1100.
      </span>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a>
    and a customised <a href="https://github.com/rtfd/sphinx_rtd_theme">rtd</a> theme.
    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>